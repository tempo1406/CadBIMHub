<Window x:Class="CadBIMHub.Views.ImportRouteWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:CadBIMHub.ViewModels"
        Title="Import lộ" 
        Height="550" 
        Width="800"
        MinHeight="550"
        MinWidth="800"
        WindowStartupLocation="CenterScreen"
        Background="White"
        AllowDrop="True"
        Drop="Window_Drop"
        DragOver="Window_DragOver">
    
    <Window.DataContext>
        <vm:ImportRouteViewModel/>
    </Window.DataContext>

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/CadBIMHub;component/Resources/Buttons.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Drop Zone -->
        <Border Grid.Row="0" 
                BorderBrush="#ddd" 
                BorderThickness="2" 
                CornerRadius="8"
                Background="#fafafa"
                AllowDrop="True"
                Drop="DropZone_Drop"
                DragOver="DropZone_DragOver"
                MouseLeftButtonDown="DropZone_Click">
            <Grid>
                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                    <Image Source="/CadBIMHub;component/Resources/Graphicloads-Android-Settings-Cloud.512.png" 
                               Width="48"
                               Height="48"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               Margin="0,0,0,15"
                        />
                   
                    <TextBlock Text="Nhấp hoặc kéo tệp vào khu vực này để tải tệp lên" 
                               FontSize="16"
                               FontWeight="SemiBold"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,8"/>
                    
                    <TextBlock Text="Chỉ chấp nhận các file Excel (.xlsx, .xls, .xlsb, .xlsm)" 
                               FontSize="13"
                               Foreground="#666"
                               HorizontalAlignment="Center"/>

                    <TextBlock Text="{Binding SelectedFileName}" 
                               FontSize="14"
                               FontWeight="Bold"
                               Foreground="#3f51b5"
                               HorizontalAlignment="Center"
                               Margin="0,20,0,0"
                               Visibility="{Binding FileSelectedVisibility}"/>
                </StackPanel>
            </Grid>
        </Border>

        <Grid Grid.Row="1" Margin="0,20,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="10"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="10"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="10"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0">
                <TextBlock Text="Tên trang tính" Margin="0,0,0,5" FontSize="13"/>
                <TextBox Text="{Binding SheetName, UpdateSourceTrigger=PropertyChanged}" 
                         Height="32" 
                         VerticalContentAlignment="Center"
                         Padding="8,0"/>
            </StackPanel>

            <StackPanel Grid.Column="2">
                <TextBlock Text="Dòng têu đề" Margin="0,0,0,5" FontSize="13"/>
                <TextBox Text="{Binding HeaderRow, UpdateSourceTrigger=PropertyChanged}" 
                         Height="32" 
                         VerticalContentAlignment="Center"
                         Padding="8,0"/>
            </StackPanel>

            <StackPanel Grid.Column="4">
                <TextBlock Text="Dòng bắt đầu" Margin="0,0,0,5" FontSize="13"/>
                <TextBox Text="{Binding StartRow, UpdateSourceTrigger=PropertyChanged}" 
                         Height="32" 
                         VerticalContentAlignment="Center"
                         Padding="8,0"/>
            </StackPanel>

            <StackPanel Grid.Column="6">
                <TextBlock Text="Dòng kết thúc" Margin="0,0,0,5" FontSize="13"/>
                <TextBox Text="{Binding EndRow, UpdateSourceTrigger=PropertyChanged}" 
                         Height="32" 
                         VerticalContentAlignment="Center"
                         Padding="8,0"/>
            </StackPanel>
        </Grid>

        <TextBlock Grid.Row="2" 
                   Margin="0,15,0,0"
                   HorizontalAlignment="Center">
            <Hyperlink Command="{Binding DownloadTemplateCommand}" 
                       TextDecorations="None">
                <TextBlock Text="Tải tệp dữ liệu mẫu" 
                           FontSize="14"
                           Foreground="#3f51b5"/>
            </Hyperlink>
        </TextBlock>

        <StackPanel Grid.Row="3" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Right" 
                    Margin="0,20,0,0">
            <Button Content="Hủy" 
                    Width="100" 
                    Height="35"
                    Margin="0,0,10,0"
                    Style="{StaticResource BtnGreyOutline}"
                    Command="{Binding CancelCommand}"/>
            <Button Content="Tiếp theo" 
                    Width="100" 
                    Height="35"
                    Style="{StaticResource BtnBlueFilled}"
                    Command="{Binding NextCommand}"/>
        </StackPanel>
    </Grid>
</Window>
